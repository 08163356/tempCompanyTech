### 场景

后端字段改变之后，如何确保前端不会因为字段的改变导致前端出错

1.如：后端来加班了，前端没来，但是后端改字段了

### 方案

方案1：线下沟通。

当要改字段的时候需要后端把可能更改的部分提前告知，前端同步更改。

方案2：JSON scheme

他是一个描述和验证json数据结构的强大工具

### JSON scheme使用

我觉得光看下面这一段就知道json scheme如何使用了，其他约束的话去查询官网即可。

```
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://example.com/product.schema.json",
  "title": "Product",
  "description": "A product from Acme's catalog",
  "type": "object",
  "properties": {
    "productId": {
      "description": "The unique identifier for a product",
      "type": "integer"
    },
    "productName": {
      "description": "Name of the product",
      "type": "string"
    },
    "price": {
      "description": "The price of the product",
      "type": "number",
      "exclusiveMinimum": 0
    },
    "tags": {
      "description": "Tags for the product",
      "type": "array",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "dimensions": {
      "type": "object",
      "properties": {
        "length": {
          "type": "number"
        },
        "width": {
          "type": "number"
        },
        "height": {
          "type": "number"
        }
      },
      "required": [ "length", "width", "height" ]
    }
  },
  "required": [ "productId", "productName", "price" ]
}
```



### 问题

1.是否需要增加一部分额外的工作去维护json scheme的结构

```
是的
```

2.如果json scheme结构变了的话，前端如何感知到，感知到后又如何做处理？

```
有现成的json schema解析器，引入了方法后调用valid方法去验证格式是否正确，如果格式不正确那么可以考虑使用原来的版本，而不是用最新的格式
```

3.json如何做自动化测试呢？

```
用validate等方法去验证你的json输出是否正确
```

4.但是后端已经的有对类型做限定了，为什么还要前端做一层鉴定呢？

```
除非前端使用的是TS语言去进行开发，如果不是的话实际上用js本身就能进行类型推导。
```



### 其他

感觉这个的比较适用的场景是：

1.跨团队、部门合作

2.远程办公

3.异地（跨省、跨国、跨语言等）合作

4.前端使用了TS等强类型语言，需要对数据格式进行强验证。

总之就是沟通协调没那么方便的场景下，比较适合使用json schema。且该方案需要在架构设计的就提出来，如果后期再提出的话会增加大量的工作量去编写json schema

reference：

[json schema使用方法](https://json-schema.org/learn/getting-started-step-by-step#nest-data)

[json schema解析器](https://github.com/hyperjump-io/json-schema)